<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .pagi{
    width: 1200px;
    height: 100px;
    margin: 0 auto;
    border: 1px solid #333;
    display: flex;
    justify-content: center;
    align-items: center;
}
.box {
    width: 1200px;
    margin: 20px auto;
}
.box >ul{
    width: 100%;
    display: flex;
    flex-wrap: wrap;
}
.box >ul >li{
    width: 22%;
    margin: 0 0 20px 20px;
    border: 1px solid #333;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 300px;
    flex-direction: column;
}

.box >ul>li >img{
    width: 153px;
    height: 206px;
    display: block;
}

.box >ul>li >p{
    font-size: 30px;
}

.sort{
    width: 100px;
    height: 40px;
    font-size: 30px;
    position: fixed;
    top: 30px;
    left: 30px;
}
    </style>
    <link rel="stylesheet" href="../lib/pagination/pagination.css">
    
    <link rel="stylesheet" href="../lib/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/common.min.css">
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../lib/swiper/css/swiper.min.css">
    <link rel="stylesheet" href="../css/list.css">
</head>
<body>
    <div class="layout-header-nav">
        <div class="container"> 
            <p class="header-benefit">
                商城优惠大酬宾，全场满59元包邮
            </p>
            <div class="header-cart">
                <a href="./cart.html" class="header-cart-link">
                    <div class="header-cart-button">
                        <div class="header-cart-button-img"></div>
                        <span class="header-cart-button-word">
                          购物车
                        </span>
                    </div>
                </a>
            </div>
            <div class="header-nav">
                <a href="./login.html" class="header-nav-item login">登录</a>
                <span class="header-nav-item">|</span>
                <a href="./register.html" class="header-nav-item">注册</a>
                <span class="header-nav-item">|</span>
                <a href="./cart.html" class="header-nav-item">我的订单</a>
                <span class="header-nav-item">|</span>
                <a href="#" class="header-nav-item">帮助中心</a>
                <span class="header-nav-item">|</span>
                <a href="#" class="header-nav-item">TP-LINK官网</a>
            </div>> 
        </div>
    </div>
    
    <div class="layout-header-search">
      <div class="container">
          <a href="#">
            <img src="" alt="" class="header-logo">
          </a>
          
            <div class="layout-banner-nav">
              <div class="banner-nav-list">
                  <div class="container2">
                      
                  </div>
              </div>
            </div>
          <form action="" class="header-search">
                <input type="text" class="header-search-input" autocomplete="off">
                <input type="button" class="header-search-submit" value="">
                
          </form>
      </div>
  
    </div>
  
    <div class="nav_box"> 
        <ul class="container">
  
        </ul>
    </div>


    
 <button class="sort">排序</button>

  <div class="box" style="display: flex;flex-wrap: wrap;">
    <ul>
      
    </ul>
  </div>
<div class="pagi m-style"></div>
 



    <script src="../lib/jquery/dist/jquery.min.js"></script>
    <script src="../lib/jquery-cookie/jquery.cookie.js"></script>
    <script src="../lib/swiper/js/swiper.min.js"></script>
    <script src="../js/list.js"></script>
    <script src="../lib/pagination/pagination.js"></script>
    <script>
        // 2-1. 准备一个变量
        var flag = true
    
        // 2-2. 准备一个变量接收数组
        var list2 = []
    
    
        // 1. 请求数据
        getList2()
        function getList2() {
          $.ajax({
            url: '../lib/list.json',
            dataType: 'json',
            success: function (res) {
             
    
              // 2. 渲染分页器
              $('.pagi').pagination({
                pageCount: Math.ceil(res.length / 12), // 总页数
                current: 1, // 当前页
                jump: true,
                coping: true,
                homePage: '首页', // 首页按钮的文本
                endPage: '末页', // 末页按钮的文本
                prevContent: '上页',
                nextContent: '下页',
                callback: function (api) { // 当你切换页面的时候会触发
                  // api.getCurrent() 获取当前是第几页
                  // console.log(api.getCurrent())
                  let curr = api.getCurrent()
    
                  // console.log(curr)
                  // 根据是第几页, 从我的总数组里面筛选出一部分数据
                  //   slice 方法包前不包后
                  var list = res.slice((curr - 1) * 12, curr * 12)
                  // console.log(list)
                  // slice 不改变原始数组, 只是从数组里面拿到一些内容
                  // splice 方法才是改变原始数组, 从原始数组里面删除
    
                  // 3-2. 每次使用分页器切换的时候渲染一次
                  bindHtml(list)
                }
              })
    
              // 3. 先把第一页的数据渲染一次
              bindHtml(res.slice(0, 12))
    
              // 2-2. 给全局变量赋值
              list2 = res
            }
          })
        }
    
        function bindHtml(list) {
          // console.log(list)
          // 根据 list 数组渲染页面就可以了
    
          let str = ''
    
          list.forEach(item => {
            str += `
              <li data-id="${ item.list_id }">
                <img src="${item.list_url}">
                <p>${ item.list_name }</p>
                <p>${ item.list_price }</p>
              </li>
            `
          })
    
          $('.box > ul').html(str)
        }
    
    
        // 2. 排序
        var btn = document.querySelector('.sort')
        btn.onclick = function () {
          // 让准备好的变量改变
          flag = !flag
    
          // 不管是什么都要把数组重组
          list2.sort(function (a, b) {
            if (flag === true) {
              return a.list_id - b.list_id
            } else {
              return b.list_id - a.list_id
            }
          })
    
          // console.log(list)
    
          $('.pagi').pagination({
            pageCount: Math.ceil(list2.length / 12), // 总页数
            current: 1, // 当前页
            jump: true,
            coping: true,
            homePage: '首页', // 首页按钮的文本
            endPage: '末页', // 末页按钮的文本
            prevContent: '上页',
            nextContent: '下页',
            callback: function (api) { // 当你切换页面的时候会触发
              let curr = api.getCurrent()
              // console.log(curr)
              var list = list2.slice((curr - 1) * 12, curr * 12)
              // 3-2. 每次使用分页器切换的时候渲染一次
              bindHtml(list)
            }
          })
    
          // 3. 先把第一页的数据渲染一次
          bindHtml(list2.slice(0, 12))
        }
    
    
        // 3. 事件委托绑定一个事件
        $('.box > ul').on('click', 'li', function () {
          const id = $(this).data('id')
          // console.log('我应该找到 list2 这个数组中 id 为 ' + id + ' 的那一条数据')
    
          // 从总的数据里面找到 id 配套的哪一个数据
          let data = {}
    
          for (let i = 0; i < list2.length; i++) {
            if (list2[i].id === id) {
              data = list2[i]
              break
            }
          }
    
          // 4. 要把这一条数据拿到 detail.html 页面去渲染一下
          //    跨页面通讯
          //    在这个页面存储起来这个数据, 要在 detail.html 里面也能拿到
          //    cookie  ->  存储起来的数据会在发送请求的时候自动携带
          //    localStorage -> 存储起来的数据不会自动携带
          // 就把我找到的这个数据存储在 localStorage 里面
          //   当你到达 detail 页面的时候, 在拿出来就可以了
          localStorage.setItem('goods_info', JSON.stringify(data))
    
          // 存储好了以后就跳转页面
          window.location.href = './detail.html'
        })
      </script>
</body>
</html>